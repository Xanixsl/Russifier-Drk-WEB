# üö¢ Russifier Drk WEB

![Header](https://github.com/user-attachments/assets/2b3c171e-d41f-4955-acac-7018a0685bbb) 

> **Russifier Drk WEB** ‚Äî —Ä—É—Å–∏—Ñ–∏–∫–∞—Ç–æ—Ä –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞ —Å–∞–π—Ç–∞ Darmoshark.cc  
> –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –ø–µ—Ä–µ–≤–æ–¥ —ç–ª–µ–º–µ–Ω—Ç–æ–≤ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è, –º–µ–Ω—é –∏ —Ç–µ–∫—Å—Ç–æ–≤ —Å–∞–π—Ç–∞ –Ω–∞ —Ä—É—Å—Å–∫–∏–π —è–∑—ã–∫.

![Badge](https://hitscounter.dev/api/hit?url=https%3A%2F%2Fgithub.com%2FXanixsl%2FRussifier-Drk-WEB&label=Visits&icon=person-fill&color=%238c68cd)

[![Version](https://img.shields.io/github/v/release/Xanixsl/Russifier-Drk-WEB?include_prereleases&label=Beta%20Version&style=flat-square)](https://github.com/Xanixsl/Russifier-Drk-WEB/releases)
[![Downloads](https://img.shields.io/github/downloads/Xanixsl/Russifier-Drk-WEB/total.svg?label=Downloads&style=flat-square)](https://raw.githubusercontent.com/Xanixsl/Russifier-Drk-WEB/main/Russifier-Drk-web.user.js)
[![License](https://img.shields.io/badge/License-MIT-green.svg?style=flat-square)](LICENSE)

---

## üìã –û–ø–∏—Å–∞–Ω–∏–µ

–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–π —Å–∫—Ä–∏–ø—Ç –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –ø–µ—Ä–µ–≤–æ–¥–∞ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞ —Å–∞–π—Ç–∞ Darmoshark.cc —Å –∞–Ω–≥–ª–∏–π—Å–∫–æ–≥–æ –Ω–∞ —Ä—É—Å—Å–∫–∏–π —è–∑—ã–∫. –°–∫—Ä–∏–ø—Ç —Ä–∞–±–æ—Ç–∞–µ—Ç –≤ –±—Ä–∞—É–∑–µ—Ä–µ —á–µ—Ä–µ–∑ –º–µ–Ω–µ–¥–∂–µ—Ä—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏—Ö —Å–∫—Ä–∏–ø—Ç–æ–≤ (Violentmonkey, Tampermonkey).

---

## ‚ú® –û—Å–Ω–æ–≤–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏

- **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –ø–µ—Ä–µ–≤–æ–¥** –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
- **–ö–Ω–æ–ø–∫–∞ –ø–µ—Ä–µ–∫–ª—é—á–∞—Ç–µ–ª—å** üåê –¥–ª—è –≤–∫–ª—é—á–µ–Ω–∏—è/–≤—ã–∫–ª—é—á–µ–Ω–∏—è –ø–µ—Ä–µ–≤–æ–¥–∞
- **–ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–ª–æ–≤–∞—Ä–µ–π** –≤ localStorage/GM-—Ö—Ä–∞–Ω–∏–ª–∏—â–µ
- **–û–±—Ä–∞–±–æ—Ç–∫–∞ –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–æ–≥–æ –∫–æ–Ω—Ç–µ–Ω—Ç–∞** —á–µ—Ä–µ–∑ MutationObserver
- **–ü–µ—Ä–µ–≤–æ–¥ –∞—Ç—Ä–∏–±—É—Ç–æ–≤**: title, placeholder, aria-label
- **–°–ø–µ—Ü–∏–∞–ª—å–Ω—ã–µ —Ñ–∏–∫—Å—ã** –¥–ª—è –ø—Ä–æ–±–ª–µ–º–Ω—ã—Ö —ç–ª–µ–º–µ–Ω—Ç–æ–≤ (`.g-select-box`)

---

## üì• –£—Å—Ç–∞–Ω–æ–≤–∫–∞

### –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è
- –ë—Ä–∞—É–∑–µ—Ä —Å —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—ã–º –º–µ–Ω–µ–¥–∂–µ—Ä–æ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏—Ö —Å–∫—Ä–∏–ø—Ç–æ–≤:
  - [Violentmonkey](https://violentmonkey.github.io/get-it/)
  - [Tampermonkey](https://www.tampermonkey.net/)
  - [Greasemonkey](https://www.greasespot.net/)

### –£—Å—Ç–∞–Ω–æ–≤–∫–∞
1. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –º–µ–Ω–µ–¥–∂–µ—Ä —Å–∫—Ä–∏–ø—Ç–æ–≤
2. **[–ù–∞–∂–º–∏—Ç–µ –¥–ª—è —É—Å—Ç–∞–Ω–æ–≤–∫–∏ —Å–∫—Ä–∏–ø—Ç–∞](https://github.com/Xanixsl/Russifier-Drk-WEB/raw/refs/heads/main/Russifier-Drk-web.user.js)**
3. –ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç–µ —É—Å—Ç–∞–Ω–æ–≤–∫—É

### –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ
1. –û—Ç–∫—Ä–æ–π—Ç–µ —Å–∞–π—Ç [Darmoshark.cc](https://www.darmoshark.cc)
2. –ù–∞–∂–º–∏—Ç–µ –∫–Ω–æ–ø–∫—É üåê –≤ –ø—Ä–∞–≤–æ–º –Ω–∏–∂–Ω–µ–º —É–≥–ª—É –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ø–µ—Ä–µ–≤–æ–¥–æ–º
3. –°–æ—Å—Ç–æ—è–Ω–∏–µ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –º–µ–∂–¥—É —Å–µ—Å—Å–∏—è–º–∏

---

## ‚öôÔ∏è –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –¥–µ—Ç–∞–ª–∏

### –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ —Å–∫—Ä–∏–ø—Ç–∞

#### 1. **–ú–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ (UserScript Headers)**
```javascript
// ==UserScript==
// @name            Russifier Drk WEB
// @version         1.0.1-pre
// @description     –†—É—Å–∏—Ñ–∏–∫–∞—Ç–æ—Ä –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞ Darmoshark.cc
// @match           https://www.darmoshark.cc/*
// @grant           GM_getValue, GM_setValue, GM_xmlhttpRequest
// @run-at          document-start
// ==/UserScript==
```

#### 2. **–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è**
```javascript
const CONFIG = {
    ENABLED_KEY: 'drk_enabled',  // –ö–ª—é—á –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è —Å–æ—Å—Ç–æ—è–Ω–∏—è
    DEBUG: false                 // –†–µ–∂–∏–º –æ—Ç–ª–∞–¥–∫–∏
};

let isEnabled = localStorage.getItem(CONFIG.ENABLED_KEY) !== '0';
```

#### 3. **–ó–∞–≥—Ä—É–∑–∫–∞ —Ä–µ—Å—É—Ä—Å–æ–≤**
- **–°–ª–æ–≤–∞—Ä—å**: –ó–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è –∏–∑ `https://raw.githubusercontent.com/Xanixsl/Russifier-Drk-WEB/main/lang/ru.json`
- **–ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ**: –°–ª–æ–≤–∞—Ä—å –∫—ç—à–∏—Ä—É–µ—Ç—Å—è –≤ localStorage/GM-—Ö—Ä–∞–Ω–∏–ª–∏—â–µ
- **CSS —Å—Ç–∏–ª–∏**: –û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–∞—è –∑–∞–≥—Ä—É–∑–∫–∞ –≤–Ω–µ—à–Ω–∏—Ö —Å—Ç–∏–ª–µ–π

```javascript
async function loadResources() {
    // –ó–∞–≥—Ä—É–∑–∫–∞ –∏ –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–ª–æ–≤–∞—Ä—è
    const cacheKey = 'drk_lang_file_ru.json';
    let cached = await getStoredValue(cacheKey);
    
    if (!cached) {
        // –ï—Å–ª–∏ –Ω–µ—Ç –≤ –∫—ç—à–µ - –∑–∞–≥—Ä—É–∂–∞–µ–º —Å GitHub
        const txt = await fetchResource(langPath);
        await setStoredValue(cacheKey, txt);
        cached = txt;
    }
    
    DICT = JSON.parse(cached); // –ü–∞—Ä—Å–∏–º –≤ –æ–±—ä–µ–∫—Ç –ø–µ—Ä–µ–≤–æ–¥–æ–≤
}
```

#### 4. **–°–∏—Å—Ç–µ–º–∞ –ø–µ—Ä–µ–≤–æ–¥–∞**

##### –ü–µ—Ä–µ–≤–æ–¥ —Ç–µ–∫—Å—Ç–æ–≤—ã—Ö —É–∑–ª–æ–≤:
```javascript
function translateTextNode(node) {
    const text = node.nodeValue.trim();
    const tr = DICT[text]; // –ò—â–µ–º –ø–µ—Ä–µ–≤–æ–¥ –≤ —Å–ª–æ–≤–∞—Ä–µ
    
    if (tr && tr !== text) {
        node.nodeValue = tr; // –ó–∞–º–µ–Ω—è–µ–º —Ç–µ–∫—Å—Ç
    }
}
```

##### –ü–µ—Ä–µ–≤–æ–¥ –∞—Ç—Ä–∏–±—É—Ç–æ–≤:
```javascript
function translateAttributes(el) {
    ['title', 'placeholder', 'aria-label'].forEach(attr => {
        const v = el.getAttribute(attr);
        if (v && DICT[v]) {
            el.setAttribute(attr, DICT[v]);
        }
    });
}
```

#### 5. **–û–±—Ä–∞–±–æ—Ç–∫–∞ –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–æ–≥–æ –∫–æ–Ω—Ç–µ–Ω—Ç–∞**

```javascript
// MutationObserver –æ—Ç—Å–ª–µ–∂–∏–≤–∞–µ—Ç –∏–∑–º–µ–Ω–µ–Ω–∏—è DOM
const observer = new MutationObserver(mutations => {
    mutations.forEach(m => {
        if (m.type === 'characterData') {
            translateTextNode(m.target); // –ò–∑–º–µ–Ω–µ–Ω–∏—è –≤ —Ç–µ–∫—Å—Ç–µ
        }
        if (m.type === 'childList') {
            m.addedNodes.forEach(n => translateDeep(n)); // –ù–æ–≤—ã–µ —ç–ª–µ–º–µ–Ω—Ç—ã
        }
    });
    
    fixSelectBoxes(); // –°–ø–µ—Ü–∏–∞–ª—å–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –ø—Ä–æ–±–ª–µ–º–Ω—ã—Ö —ç–ª–µ–º–µ–Ω—Ç–æ–≤
});

// –ù–∞—á–∏–Ω–∞–µ–º –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ
observer.observe(document.documentElement, {
    subtree: true,
    childList: true,
    characterData: true
});
```

#### 6. **–°–ø–µ—Ü–∏–∞–ª—å–Ω—ã–µ —Ñ–∏–∫—Å—ã**

```javascript
/* ================= üî• FIX FOR g-select-box ================= */
function fixSelectBoxes() {
    // –û–±—Ä–∞–±–æ—Ç–∫–∞ —ç–ª–µ–º–µ–Ω—Ç–æ–≤ —Å –∫–ª–∞—Å—Å–æ–º .g-select-box
    document.querySelectorAll('.g-select-box span').forEach(span => {
        const t = span.textContent.trim();
        if (DICT[t] && DICT[t] !== t) {
            span.textContent = DICT[t]; // –ó–∞–º–µ–Ω–∞ —Ç–µ–∫—Å—Ç–∞
        }
    });
}
```

#### 7. **–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å**

```javascript
function createToggleButton() {
    const btn = document.createElement('div');
    btn.id = 'drk-translate-toggle';
    btn.textContent = 'üåê';
    btn.title = '–í–∫–ª—é—á–∏—Ç—å / –≤—ã–∫–ª—é—á–∏—Ç—å –ø–µ—Ä–µ–≤–æ–¥';
    
    btn.onclick = () => {
        isEnabled = !isEnabled;
        localStorage.setItem(CONFIG.ENABLED_KEY, isEnabled ? '1' : '0');
        
        if (isEnabled) {
            // –í–∫–ª—é—á–µ–Ω–∏–µ –ø–µ—Ä–µ–≤–æ–¥–∞
            applyTranslation();
            initObserver();
        } else {
            // –í—ã–∫–ª—é—á–µ–Ω–∏–µ - –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∞ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
            location.reload();
        }
    };
    
    document.body.appendChild(btn);
}
```

#### 8. **–ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è**

```javascript
function init() {
    createToggleButton(); // –°–æ–∑–¥–∞–µ–º –∫–Ω–æ–ø–∫—É —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è
    
    loadResources().then(() => {
        if (isEnabled) {
            applyTranslation(); // –ü—Ä–∏–º–µ–Ω—è–µ–º –ø–µ—Ä–µ–≤–æ–¥
            initObserver();     // –ó–∞–ø—É—Å–∫–∞–µ–º –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ
        }
    });
}

// –ó–∞–ø—É—Å–∫ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
if (document.readyState === 'loading') {
    document.addEventListener('DOMContentLoaded', init);
} else {
    init();
}
```

### –†–∞–±–æ—Ç–∞ —Å–æ —Å–ª–æ–≤–∞—Ä–µ–º

**–°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Å–ª–æ–≤–∞—Ä—è (ru.json):**
```json
{
    "Home": "–ì–ª–∞–≤–Ω–∞—è",
    "Settings": "–ù–∞—Å—Ç—Ä–æ–π–∫–∏",
    "Reset": "–°–±—Ä–æ—Å",
    "Import": "–ò–º–ø–æ—Ä—Ç",
    "Export": "–≠–∫—Å–ø–æ—Ä—Ç"
}
```

**–ü—Ä–∏–Ω—Ü–∏–ø —Ä–∞–±–æ—Ç—ã:**
1. –°–∫—Ä–∏–ø—Ç –∏—â–µ—Ç —Ç–æ—á–Ω–æ–µ —Å–æ–≤–ø–∞–¥–µ–Ω–∏–µ —Ç–µ–∫—Å—Ç–∞ –≤ —Å–ª–æ–≤–∞—Ä–µ
2. –ü—Ä–∏ –Ω–∞—Ö–æ–∂–¥–µ–Ω–∏–∏ —Å–æ–≤–ø–∞–¥–µ–Ω–∏—è –∑–∞–º–µ–Ω—è–µ—Ç —Ç–µ–∫—Å—Ç –Ω–∞ –ø–µ—Ä–µ–≤–æ–¥
3. –ö—ç—à–∏—Ä—É–µ—Ç —Å–ª–æ–≤–∞—Ä—å –¥–ª—è —É–º–µ–Ω—å—à–µ–Ω–∏—è —Å–µ—Ç–µ–≤—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤

### –ú–µ—Ö–∞–Ω–∏–∑–º —Ö—Ä–∞–Ω–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö

#### localStorage:
- `drk_enabled`: '1' (–≤–∫–ª—é—á–µ–Ω) –∏–ª–∏ '0' (–≤—ã–∫–ª—é—á–µ–Ω)
- `drk_lang_file_ru.json`: –∫—ç—à–∏—Ä–æ–≤–∞–Ω–Ω—ã–π —Å–ª–æ–≤–∞—Ä—å –ø–µ—Ä–µ–≤–æ–¥–æ–≤

#### GM API (–µ—Å–ª–∏ –¥–æ—Å—Ç—É–ø–Ω–æ):
```javascript
// –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏ GM API
function hasGMStorage() {
    return typeof GM_getValue === 'function' && typeof GM_setValue === 'function';
}

// –£–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ —Ä–∞–±–æ—Ç—ã —Å —Ö—Ä–∞–Ω–∏–ª–∏—â–µ–º
async function getStoredValue(key) {
    if (hasGMStorage()) {
        return GM_getValue(key); // –ò—Å–ø–æ–ª—å–∑—É–µ–º GM API
    }
    return localStorage.getItem(key); // Fallback –Ω–∞ localStorage
}
```

### –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ –∏ –æ—Ç–ª–∞–¥–∫–∞

```javascript
const log = (...a) => CONFIG.DEBUG && console.log('[DRK-RU]', ...a);

// –ü—Ä–∏–º–µ—Ä—ã –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è:
log('loadResources start', { langFile: 'ru.json' });
log('translateTextNode: replacing', text, '->', tr);
log('Failed to fetch current language file:', e);
```

---

## üêõ –ò–∑–≤–µ—Å—Ç–Ω—ã–µ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è

1. **–°—Ç–∞—Ç–∏—á–µ—Å–∫–∏–µ –ø–µ—Ä–µ–≤–æ–¥—ã**: –¢—Ä–µ–±—É–µ—Ç—Å—è —Ç–æ—á–Ω–æ–µ —Å–æ–≤–ø–∞–¥–µ–Ω–∏–µ —Ç–µ–∫—Å—Ç–∞ —Å–æ —Å–ª–æ–≤–∞—Ä–µ–º
2. **–î–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–µ —ç–ª–µ–º–µ–Ω—Ç—ã**: –ù–µ–∫–æ—Ç–æ—Ä—ã–µ —ç–ª–µ–º–µ–Ω—Ç—ã –º–æ–≥—É—Ç —Ç—Ä–µ–±–æ–≤–∞—Ç—å —Ä—É—á–Ω–æ–π –æ–±—Ä–∞–±–æ—Ç–∫–∏
3. **–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å**: –ü—Ä–∏ –±–æ–ª—å—à–æ–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–µ —ç–ª–µ–º–µ–Ω—Ç–æ–≤ –º–æ–∂–µ—Ç –±—ã—Ç—å –∑–∞–º–µ—Ç–Ω–∞ –∑–∞–¥–µ—Ä–∂–∫–∞
4. **–û–±–Ω–æ–≤–ª–µ–Ω–∏—è —Å–∞–π—Ç–∞**: –ü—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã —Å–∞–π—Ç–∞ –º–æ–∂–µ—Ç –ø–æ—Ç—Ä–µ–±–æ–≤–∞—Ç—å—Å—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å–∫—Ä–∏–ø—Ç–∞

---

## üìÑ –õ–∏—Ü–µ–Ω–∑–∏—è

MIT License - —Å–º–æ—Ç—Ä–∏—Ç–µ —Ñ–∞–π–ª [LICENSE](LICENSE) –¥–ª—è –¥–µ—Ç–∞–ª–µ–π.
